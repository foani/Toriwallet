# TORI 지갑 내부 보안 감사 보고서 - 브라우저 확장 프로그램 (Part 2)

## 발견된 취약점 (계속)

### 낮음(Low)

#### 1. 암호 강도 검증 부족 (L-01)

**위치**: `packages/extension/src/popup/pages/CreateWallet.tsx`

**설명**: 지갑 생성 및 잠금 해제에 사용되는 암호의 강도에 대한 검증이 충분하지 않아, 취약한 암호 사용이 가능합니다.

**권장 수정 사항**: 최소 길이, 복잡성 요구사항(대소문자, 숫자, 특수문자 조합) 등을 포함한 암호 강도 검증을 구현하고, 사용자에게 암호 강도를 시각적으로 표시합니다.

**상태**: 수정 완료

#### 2. 백그라운드 스크립트의 불필요한 권한 (L-02)

**위치**: `packages/extension/public/manifest.json`

**설명**: 확장 프로그램이 필요 이상의 권한을 요청하고 있어, 보안 위험이 증가할 수 있습니다.

**권장 수정 사항**: 최소 권한의 원칙에 따라 확장 프로그램이 필요로 하는 최소한의 권한만 요청하도록 수정합니다.

**상태**: 수정 완료

#### 3. 세션 관리 취약점 (L-03)

**위치**: `packages/extension/src/background/authManager.ts`

**설명**: 세션 타임아웃 및 세션 관리 메커니즘이 충분히 안전하지 않아, 다양한 세션 관련 공격에 취약할 수 있습니다.

**권장 수정 사항**: 적절한 세션 타임아웃을 구현하고, 세션 토큰을 안전하게 관리하며, 세션 무효화 메커니즘을 강화합니다.

**상태**: 수정 중

### 정보성(Informational)

#### 1. 개발자 모드 플래그 제거 필요 (I-01)

**위치**: `packages/extension/src/config/index.ts`

**설명**: 프로덕션 빌드에 개발자 모드 플래그가 활성화된 상태로 남아있어, 불필요한 디버그 정보가 노출될 수 있습니다.

**권장 수정 사항**: 프로덕션 빌드에서는 개발자 모드 플래그를 비활성화하고, 디버그 로그를 제거합니다.

**상태**: 수정 완료

#### 2. 일관되지 않은 오류 처리 (I-02)

**위치**: 여러 파일

**설명**: 확장 프로그램 전반에 걸쳐 오류 처리 방식이 일관되지 않아, 일부 오류가 적절히 처리되지 않거나 사용자에게 명확히 표시되지 않을 수 있습니다.

**권장 수정 사항**: 일관된 오류 처리 방식을 도입하고, 사용자에게 오류를 명확하게 표시하며, 중요한 오류는 로깅하여 디버깅을 용이하게 합니다.

**상태**: 수정 중

## 취약점 수정 현황

현재까지 11개의 발견된 취약점 중 7개가 수정 완료되었으며, 4개는 수정 중입니다.

| ID    | 심각도 | 상태       |
|-------|-------|-----------|
| C-01  | 치명적| 수정 완료  |
| H-01  | 높음  | 수정 완료  |
| H-02  | 높음  | 수정 중    |
| M-01  | 중간  | 수정 완료  |
| M-02  | 중간  | 수정 완료  |
| M-03  | 중간  | 수정 중    |
| L-01  | 낮음  | 수정 완료  |
| L-02  | 낮음  | 수정 완료  |
| L-03  | 낮음  | 수정 중    |
| I-01  | 정보  | 수정 완료  |
| I-02  | 정보  | 수정 중    |

## 브라우저 확장 프로그램별 특수 보안 권장 사항

### 1. 피싱 방지 강화

확장 프로그램 UI에 고유한 식별 요소를 추가하여 사용자가 피싱 사이트와 실제 TORI 지갑 확장 프로그램을 구별할 수 있게 합니다. 이를 위해 다음과 같은 방법을 고려할 수 있습니다:

- 사용자 설정 가능한 고유 색상 또는 아이콘
- 랜덤하게 생성된 사용자별 식별 코드
- 팝업 창에 고유한 워터마크 또는 디자인 요소

### 2. 콘텐츠 보안 정책(CSP) 강화

확장 프로그램의 `manifest.json`에서 콘텐츠 보안 정책을 강화하여 XSS 및 데이터 주입 공격을 방지합니다:

```json
{
  "content_security_policy": "script-src 'self'; object-src 'self'; connect-src 'self' https://api.creatachain.com;"
}
```

### 3. 웹3 프로바이더 보안

- 프로바이더 API에 대한 접근을 제한하여 승인된 도메인만 접근할 수 있도록 합니다.
- 민감한 메서드 호출 시 항상 사용자 확인을 요구합니다.
- 트랜잭션 서명 요청 시 상세한 정보를 표시하여 사용자가 의도하지 않은 트랜잭션을 식별할 수 있게 합니다.

### 4. 확장 프로그램 업데이트 무결성 검증

확장 프로그램 업데이트 시 무결성을 검증하여 악성 코드 주입을 방지합니다:

- 모든 업데이트는 디지털 서명을 통해 검증합니다.
- 업데이트 서버와의 통신은 항상 HTTPS를 통해 이루어집니다.
- 예상치 못한 업데이트가 있는 경우 사용자에게 알립니다.

## 결론

TORI 지갑 브라우저 확장 프로그램에 대한 내부 보안 감사 결과, 치명적인 취약점 1건을 포함한 다양한 심각도의 보안 이슈가 식별되었습니다. 치명적 취약점과 대부분의 높은 심각도 취약점은 이미 수정이 완료되었으며, 나머지 이슈들도 현재 수정 중입니다.

확장 프로그램의 보안은 전체 지갑 시스템의 보안에 중요한 영향을 미치므로, 모든 취약점을 철저히 수정하고 추가적인 보안 강화 조치를 취할 것을 권장합니다. 특히 인페이지 스크립트 보안, dApp 연결 관리, 트랜잭션 서명 프로세스에 대한 추가적인 보안 강화가 필요합니다.

## 다음 단계

1. 모든 발견된 취약점에 대한 수정 완료
2. 수정된 코드에 대한 추가 검증 수행
3. 외부 보안 감사 준비
4. 확장 프로그램 특화 보안 가이드라인 작성 및 개발자 교육

이 보고서는 2025년 5월 9일에 작성되었으며, TORI 지갑 프로젝트의 내부 보안 팀에 의해 검토되었습니다.